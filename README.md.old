
# Music Generator Company â€“ RAG Prototype

![Music Generator Company](assets/image.png)

## Overview

This repository contains a **proof of concept** created for CloudWalk's **Level 2.3 â€“ Music Generator Company** challenge.

This prototype demonstrates **real RAG implementation** using **Ollama**, **LangChain**, and **ChromaDB** to validate the proposed architecture with production-ready AI technologies.

---

## Scope and Intent

This prototype demonstrates:

* **Real RAG** with ChromaDB vector search
* **Local LLM** using Ollama (llama2)
* **LangChain** for prompt engineering and LLM orchestration
* Multi-agent coordination with AI-powered decision making
* Clear separation of responsibilities
* Pragmatic engineering choices

---

## Architecture Decisions

### Real RAG Implementation

This prototype uses **production-ready RAG technologies**:

* **ChromaDB**: Vector database for semantic search and similarity matching
* **LangChain**: LLM orchestration, prompt templates, and chains
* **Ollama**: Local LLM inference (llama2 model)

Music generation is simulated, but billing remains deterministic (no AI needed).

---

### RAG Use Cases

**Music Agent**

* Uses **ChromaDB vector search** to find similar tracks
* **Ollama LLM** generates creative titles, genres, and moods
* Contextual decision-making based on time of day and recent history
* Fallback to deterministic logic if LLM fails

**Marketing Agent**

* **Vector search** retrieves best-performing post templates
* **Ollama LLM** generates engaging social media content
* Context-aware hashtag selection based on genre
* Adapts to engagement metrics from knowledge base

**Billing Agent**

* Uses deterministic logic only
* No AI involved - billing doesn't benefit from LLM reasoning

---

### Knowledge Base

The system uses a **hybrid approach**:

* **ChromaDB vector store**: Semantic search for tracks and marketing templates
* **Local JSON file**: Base configuration and metadata
* **Persistent storage**: Vector embeddings persist across runs in `./chroma_db/`

This architecture demonstrates scalable RAG patterns suitable for production.

---

### LLM Integration

**Ollama** provides local LLM inference:

* No API keys or external services required
* Privacy-preserving (all data stays local)
* Uses **llama2** model for text generation
* Fast inference on local hardware
* Fallback to deterministic generation ensures reliability

---

## System Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Autonomous Music Company             â”‚
â”‚   (Ollama + LangChain + ChromaDB)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
â”‚ Music â”‚ â”‚Bill â”‚ â”‚Marketing â”‚
â”‚ Agent â”‚ â”‚Agentâ”‚ â”‚  Agent   â”‚
â”‚ (LLM) â”‚ â”‚(Det)â”‚ â”‚  (LLM)   â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚        â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ChromaDB      â”‚
    â”‚ Vector Store    â”‚
    â”‚  + JSON Data    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Ollama LLM     â”‚
    â”‚   (llama2)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Running the Application

### Option 1: Docker (Recommended for Production)

```bash
# Linux/Mac
./deploy.sh

# Windows PowerShell
.\deploy.ps1
```

Access the web interface at http://localhost:5000

### Option 2: Local Development

**Prerequisites:**
1. Python 3.8+
2. Ollama (optional): https://ollama.ai

**Setup:**
```bash
# Install dependencies
pip install -r requirements.txt

# Copy environment file
cp .env.example .env

# Run web interface
python web_app.py
```

Access at http://localhost:5000

### Option 3: CLI Mode

```bash
python main.py
```

## Features

### Web Interface
- **Ollama Prompt Interface**: Send custom prompts directly to Ollama
- **Music Generation**: Generate tracks with one click
- **Twitter Integration**: Post immediately or schedule tweets
- **Real-time Status**: Monitor system health and services
- **Background Scheduler**: Automatic processing of scheduled posts

### Twitter Scheduling
- Schedule posts for specific times
- View pending scheduled posts
- Automatic posting at scheduled times
- Works in simulation mode without API credentials

### Production Ready
- Docker deployment with health checks
- Gunicorn WSGI server
- Background task scheduler
- Comprehensive logging
- Environment-based configuration

## API Endpoints

### Music Generation
- `POST /api/generate` - Generate new music track
- `GET /api/status` - System health and status

### Ollama Integration
- `POST /api/ollama/prompt` - Send custom prompt to Ollama
  ```json
  {"prompt": "Your prompt here"}
  ```

### Marketing
- `POST /api/marketing/create` - Create marketing post for track

### Twitter
- `POST /api/twitter/post-now` - Post immediately
  ```json
  {"content": "Your tweet"}
  ```
- `POST /api/twitter/schedule` - Schedule post
  ```json
  {"content": "Your tweet", "scheduled_time": "2026-01-11T14:30:00"}
  ```
- `GET /api/twitter/pending` - Get scheduled posts
- `GET /api/twitter/posted` - Get posted content

### Operations
- `POST /api/operations/run` - Run all daily operations

Example output:

```
INFO - Initializing Music Generator Company
INFO - Initializing agents...
INFO - All agents initialized successfully
INFO - Starting daily operations
INFO - Generating music track
INFO - Generated track: Bright Flow (electronic)
INFO - Processing monthly billing
INFO - Billing processed: $5.00 revenue
INFO - Creating marketing content
INFO - Marketing post created for Bright Flow

============================================================
DAILY OPERATIONS SUMMARY
============================================================

ğŸµ Music Generation
   Track: Bright Flow
   Genre: electronic
   Mood: energetic
   Method: llm

ğŸ’³ Billing
   Processed: 5/5 users
   Revenue: $5.00
   Failed: 0

ğŸ“± Marketing
   Platform: twitter
   Post: ğŸµ Fresh electronic vibes! Check out 'Bright Flow' ğŸ”¥ #Electronic #EDM
   Scheduled: 9am
   Engagement Score: 850

============================================================
âœ… Operations completed
============================================================
```

See [SETUP.md](SETUP.md) for detailed setup instructions and architecture documentation.

---

## Notes

This prototype demonstrates:

* **Production-ready RAG**: ChromaDB + LangChain architecture
* **Local-first AI**: Ollama runs entirely on your machine
* **Context-aware decisions**: Vector search improves agent intelligence
* **Graceful degradation**: Fallback logic ensures reliability
* **Scalable patterns**: Architecture suitable for production systems

Technology stack:
- **Ollama**: Local LLM inference (llama2)
- **LangChain**: LLM orchestration and prompt management
- **ChromaDB**: Vector database for semantic search
- **Python**: Application logic and agent coordination

---

## Repository Contents

* **Core Application**
  * `main.py` â€“ CLI entry point
  * `web_app.py` â€“ Web interface and API server
  * `config.py` â€“ Configuration and constants
  * `orchestrator.py` â€“ Agent coordination

* **Services**
  * `llm_service.py` â€“ LLM abstraction (Ollama)
  * `llm_service_simple.py` â€“ Fallback without LangChain
  * `knowledge.py` â€“ Vector store management (ChromaDB)
  * `knowledge_simple.py` â€“ Fallback JSON storage
  * `twitter_service.py` â€“ Twitter posting and scheduling
  * `scheduler.py` â€“ Background task scheduler

* **Agents**
  * `agents/music_agent.py` â€“ Music generation
  * `agents/billing_agent.py` â€“ Subscription billing
  * `agents/marketing_agent.py` â€“ Content generation

* **Web Interface**
  * `templates/index.html` â€“ Dashboard UI

* **Deployment**
  * `Dockerfile` â€“ Container configuration
  * `docker-compose.yml` â€“ Multi-service orchestration
  * `deploy.sh` â€“ Linux/Mac deployment script
  * `deploy.ps1` â€“ Windows deployment script
  * `requirements.txt` â€“ Python dependencies

* **Documentation**
  * `README.md` â€“ This document
  * `SETUP.md` â€“ Setup and architecture guide
  * `DEPLOYMENT.md` â€“ Production deployment guide
  * `IMPROVEMENTS.md` â€“ Refactoring documentation

* **Configuration**
  * `.env.example` â€“ Environment template
  * `knowledge_base.json` â€“ Base configuration data
  * `twitter_schedule.json` â€“ Scheduled posts (generated)

---

**Author:** Juan
**Challenge:** CloudWalk AI Wizard â€“ Level 2.3


